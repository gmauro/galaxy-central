var add_bookmark=function(b,a){var g=$("#bookmarks-container"),d=$("<div/>").addClass("bookmark").appendTo(g),c=$("<div/>").addClass("delete-icon-container").appendTo(d).click(function(){d.slideUp("fast");d.remove();view.has_changes=true;return false}),e=$("<a href=''/>").addClass("icon-button delete").appendTo(c),f=$("<div/>").addClass("position").appendTo(d),h=$("<a href=''/>").text(b).appendTo(f).click(function(){view.go_to(b);return false});annotation_div=get_editable_text_elt(a,true).addClass("annotation").appendTo(d);view.has_changes=true;return d};var addable_track_types={LineTrack:LineTrack,FeatureTrack:FeatureTrack,ReadTrack:ReadTrack};var track_from_dict=function(a){return new addable_track_types[a.track_type](a.name,view,a.hda_ldda,a.dataset_id,a.prefs,a.filters,a.tool)};var create_visualization=function(d,j,a,g,l,k,n){view=new View(d,j,a,g,l);view.editor=true;if(k){var m,b,h,e;for(var c=0;c<k.length;c++){m=k[c];b=track_from_dict(m);e=view;if(m.is_child){e=h}else{h=b}e.add_track(b)}}if(n){var f;for(var c=0;c<n.length;c++){f=n[c];add_bookmark(f.position,f.annotation)}}view.has_changes=false;return view};var init_keyboard_nav=function(a){$(document).keydown(function(b){if($(b.srcElement).is(":input")){return}switch(b.which){case 37:a.move_fraction(0.25);break;case 38:var c=Math.round(a.viewport_container.height()/15);a.viewport_container.scrollTo("-="+c+"px");break;case 39:a.move_fraction(-0.25);break;case 40:var c=Math.round(a.viewport_container.height()/15);a.viewport_container.scrollTo("+="+c+"px");break}})};