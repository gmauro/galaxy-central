define(["mvc/base-mvc","mvc/collection/dataset-collection-base","mvc/history/history-content-base-view","utils/localization"],function(a,c,g,b){var f=g.HistoryContentViewMixin,d=c.DCBaseView;var e=d.extend(a.mixin(f,{className:"dataset hdca history-panel-hda",initialize:function(h){if(h.logger){this.logger=this.model.logger=h.logger}this.log(this+".initialize:",h);d.prototype.initialize.call(this,h);f.initialize.call(this,h)},_template:function(){return e.templates.skeleton(this.model.toJSON())},events:_.extend(_.clone(f.events),{}),_renderBody:function(){var h=$(d.templates.body(this.model.toJSON()));if(this.expanded){h.show()}return h},expand:function(){this.warn(this+".expand");var h=this;if(this.model.inReadyState()&&!this.model.hasDetails()){this.model.fetch().always(function(i){h.expanded=true;h.trigger("expanded",h)})}else{h.expanded=true;h.trigger("expanded",h)}},toString:function(){var h=(this.model)?(this.model+""):("(no model)");return"HDCABaseView("+h+")"}}));e.templates=e.prototype.templates=(function(){var h=_.template(['<div class="dataset hdca">','<div class="dataset-warnings">',"<% if ( collection.deleted ) { %>",'<div class="dataset-deleted-msg warningmessagesmall"><strong>',b("This collection has been deleted."),"</div>","<% } %>","<% if ( !collection.visible ) { %>",'<div class="dataset-hidden-msg warningmessagesmall"><strong>',b("This collection has been hidden."),"</div>","<% } %>","</div>",'<div class="selector"><span class="fa fa-2x fa-square-o"></span></div>','<div class="primary-actions"></div>','<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="hid"><%- collection.hid %></span> ','<span class="name"><%- collection.name %></span>',"</div>",'<div class="subtitle">','<% if( collection.collection_type === "list" ){ %>',b("a list of datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',b("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',b("a list of paired datasets"),"<% } %>","</div>","</div>",'<div class="details"></div>',"</div>"].join(""));var i=_.template(['<div class="details">','<div class="summary">',b("A dataset collection."),"</div>"].join(""));return{skeleton:function(j){return h({_l:b,collection:j})},body:function(j){return i({_l:b,collection:j})}}}());return{HDCABaseView:e}});