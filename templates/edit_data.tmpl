<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

#from galaxy.util.expressions import ExpressionContext 

<html>
  <head>
    <title>Galaxy</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link href="$h.url_for('/static/style/base.css')" rel="stylesheet" type="text/css" />
  </head>
  <body>

    #if $getVar( 'error_message', None )
      <div class="errormessagesmall">$error_message</div>
      <p></p>
    #end if

    #def do_metadata( $metadata, $data )
      #for $element in $metadata
        <tr>
          <td width="30%" align="right">$element.spec.desc</td>
          <td width="50%" align="left">$element.get_html()</td>
        </tr>
      #end for
    #end def

    #def datatype( $dataset, $datatypes )
      <select name="datatype">
        #$datatypes.sort()
        #for $ext in $datatypes:
          #if $dataset.ext == $ext
            <option value="$ext" selected="yes">$ext</option>
          #else
            <option value="$ext">$ext</option>
          #end if
        #end for
      </select>
    #end def

    <div class="toolFormTitle">Edit Attributes</div>
  
    #set $converters = $data.get_converter_types()

    <table border="1" width="100%">
      #if $len($converters) > 0
        <tr>
          <td>
            <div class="toolFormBody">
              <form name="convert_data" action="$h.url_for( action='edit' )" method="post">
                <table width="100%" border="0">
                  <tr>
                    <td width="30%" align="right">Convert data format</td>
                    <td  width="50%" align="left">
                      <input type="hidden" name="id" value="$data.id">
                      <select name="target_type">
                        #for $key, $value in $converters.items():
                          <option value="$key">$value.name[8:]</option>
   	                    #end for
                      </select>
                    </td>
                    <td width="20%" align="left" valign="center">
                      <input type="submit" name="convert_data" value="Convert">
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          </td>
        </tr>
      #end if
      <tr>
        <td>
          <div class="toolFormBody">
            <form name="datatype" action="$h.url_for( action='edit' )" method="post">
              <table width="100%" border="0">
                <tr>
                  <td width="30%" align="right">Set data type</td>
                  <td width="50%" align="left">
                    <input type="hidden" name="id" value="$data.id">
                    $datatype( $data, $datatypes )
                  </td>
	              <td width="20%" align="left" valign="center">
	                <input type="submit" name="change" value="Save">
	              </td>
	            </tr>
              </table>
            </form>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="toolFormBody">
            <form name="tool_form" action="$h.url_for( action='edit' )" method="post">
              <input type="hidden" name="id" value="$data.id">
              <table width="100%" border="0">
                <tr><td align="center" colspan="3"><b>Set other attributes</b></td></tr>
                <tr>
                  <td width="30%" align="right">Name:</td>
                  <td width="50%" align="left"><input type="text" name="name" value="$data.name" size="40"></td>
                  <td width="20%" align="left" valign="center" rowspan="8"><input type="submit" name="save" value="Save"></td>
                </tr>
	            <tr>
	              <td width="30%" align="right">Info:</td>
	              <td width="50%" align="left">
	                <input type="text" name="info" value="$data.info" size="40">
	                <input type="hidden" name="id" value="$data.id">
	              </td>
	            </tr>
                $do_metadata( $metadata, $data )  
              </table>
            </form>
          </div>
        </td>
      </tr>
    </table>

    <div class="toolHelp">
    <div class="toolHelpBody">
    </div>        
    </div>
  </body>
</html>
