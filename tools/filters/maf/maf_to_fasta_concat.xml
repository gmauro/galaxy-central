<tool id="MAF_To_Fasta_Concat1" name="Maf to concatenated FASTA">
    <description>Converts a MAF formated file to FASTA format</description>
    <command interpreter="python2.4">maf_to_fasta_concat.py $species $input1 $out_file1</command>
    <inputs>
        <page>
            <param format="maf" name="input1" type="data" label="MAF file"/>
        </page>
        <page>
            <param name="species" type="select" label="Species to extract" dynamic_options="get_available_species( input1.file_name )" display="checkboxes" multiple="true"/>
        </page>
    </inputs>
    <outputs>
        <data format="fasta" name="out_file1" />
    </outputs>
    <tests>
      <test>
        <param name="input1" value="3.maf"/>
        <param name="species" values="canFam1,hg17,mm5,panTro1,rn3"/>
        <output name="out_file1" file="cf_maf2fasta_concat.dat"/>
      </test>
    </tests>
    <help>

.. class:: infomark

What is the differences between these two tools: **MAF to FASTA** and **MAF to concatenated FASTA** (scroll down for the description of MAF format)?

 * **MAF to FASTA** converts a single MAF block to a single FASTA block. For example, if you have 6 MAF blocks, they will be converted to 6 FASTA blocks.
 * **MAF to concatenated FASTA** converts MAF blocks to a single aggregated FASTA block. For example, if you have 6 MAF blocks, they will be converted and concatenated into a single FASTA block.

In the future these two tools will be merged.

-------

**What it does**

This tool converts MAF blocks to FASTA format and concatenates them into a single FASTA block.  

The interface for this tool contains two pages (steps): 

 * **Step 1 of 2**. Choose multiple alignments from history to be converted to FASTA format.
 * **Step 2 of 2**. Choose species from the alignment to be included in the output.

-----

**Example**:

The following alignment::

  ##maf version=1
  a score=68686.000000
  s hg18.chr20     56827368 75 +  62435964 GACAGGGTGCATCTGGGAGGG---CCTGCCGGGCCTTTA-TTCAACACTAGATACGCCCCATCTCCAATTCTAATGGAC- 
  s panTro2.chr20  56528685 75 +  62293572 GACAGGGTGCATCTGAGAGGG---CCTGCCAGGCCTTTA-TTCAACACTAGATACGCCCCATCTCCAATTCTAATGGAC- 
  s rheMac2.chr10  89144112 69 -  94855758 GACAGGGTGCATCTGAGAGGG---CCTGCTGGGCCTTTG-TTCAAAACTAGATATGCCCCAACTCCAATTCTA------- 
  s mm8.chr2      173910832 61 + 181976762 AGAAGGATCCACCT------------TGCTGGGCCTCTGCTCCAGCAAGACCCACCTCCCAACTCAAATGCCC------- 
  s canFam2.chr24  46551822 67 +  50763139 CG------GCGTCTGTAAGGGGCCACCGCCCGGCCTGTG-CTCAAAGCTACAAATGACTCAACTCCCAACCGA------C 

  a score=10289.000000
  s hg18.chr20    56827443 37 + 62435964 ATGTGCAGAAAATGTGATACAGAAACCTGCAGAGCAG 
  s panTro2.chr20 56528760 37 + 62293572 ATGTGCAGAAAATGTGATACAGAAACCTGCAGAGCAG 
  s rheMac2.chr10 89144181 37 - 94855758 ATGTGCGGAAAATGTGATACAGAAACCTGCAGAGCAG 

will be converted to (**note** that because mm8 (mouse) and canFam2 (dog) are absent from the second block, they are replaced with gaps after concatenation)::

  &gt;canFam2
  CG------GCGTCTGTAAGGGGCCACCGCCCGGCCTGTG-CTCAAAGCTACAAATGACTCAACTCCCAACCGA------C-------------------------------------
  &gt;hg18
  GACAGGGTGCATCTGGGAGGG---CCTGCCGGGCCTTTA-TTCAACACTAGATACGCCCCATCTCCAATTCTAATGGAC-ATGTGCAGAAAATGTGATACAGAAACCTGCAGAGCAG
  &gt;mm8
  AGAAGGATCCACCT------------TGCTGGGCCTCTGCTCCAGCAAGACCCACCTCCCAACTCAAATGCCC--------------------------------------------
  &gt;panTro2
  GACAGGGTGCATCTGAGAGGG---CCTGCCAGGCCTTTA-TTCAACACTAGATACGCCCCATCTCCAATTCTAATGGAC-ATGTGCAGAAAATGTGATACAGAAACCTGCAGAGCAG
  &gt;rheMac2
  GACAGGGTGCATCTGAGAGGG---CCTGCTGGGCCTTTG-TTCAAAACTAGATATGCCCCAACTCCAATTCTA-------ATGTGCGGAAAATGTGATACAGAAACCTGCAGAGCAG

------

.. class:: infomark

**About formats**

 **MAF format** multiple alignment format file. This format stores multiple alignments at the DNA level between entire genomes. 

 - The .maf format is line-oriented. Each multiple alignment ends with a blank line.
 - Each sequence in an alignment is on a single line.
 - Lines starting with # are considered to be comments.
 - Each multiple alignment is in a separate paragraph that begins with an "a" line and contains an "s" line for each sequence in the multiple alignment.
 - Some MAF files may contain two optional line types: 

   - An "i" line containing information about what is in the aligned species DNA before and after the immediately preceding "s" line; 
   - An "e" line containing information about the size of the gap between the alignments that span the current block.


    </help>
    <code file="maf_to_fasta_code.py"/>
</tool>
