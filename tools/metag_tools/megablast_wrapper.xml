<tool id="megablast_wrapper" name="Run Megablast">
	<description>on genomic data</description>
	<command interpreter="python">megablast_wrapper.py $source_select $input_query bed $output1 $word_size $iden_cutoff $disc_word $disc_type $filter_query</command>
	<inputs>
		<param name="input_query" type="data" format="fasta" label="Query Sequence"/>
		<param name="source_select" type="select" display="radio" label="Target database">
			<!-- <options from_file="/depot/data2/galaxy/blastdb.loc" /> -->
			<option value="nt">nt (for nucleotides)</option>
		</param>
		<!-- <param name="something" type="blastdb" label="database"/> --> 
<!-- 
		<param name="output_format" type="select" display="radio" label="Output Type">
			<option value="bed">BED</option>
			<option value="maf">MAF</option>
		</param>
-->
		<param name="word_size" type="select" label="Word size (length of best perfect match)">
			<option value="28">28</option>
			<option value="16">16</option>
		</param>
		<param name="iden_cutoff" type="float" size="15" value="0.0" label="Identity percentage cut-off" help="Real" />
		<param name="disc_word" type="integer" size="15" value="0" label="Length of a discontiguous word template" help="contiguous word if 0"/>
		<param name="disc_type" type="select" label="Type of a discontiguous word template">
			<option value="0">0 - coding</option>
			<option value="1">1 - optimal</option>
			<option value="2">2 - two simultaneous</option>
		</param>
		<param name="filter_query" type="select" label="Filter query sequence">
			<option value="T">Yes</option>
			<option value="F">No</option>
		</param>
	</inputs>
	<outputs>
		<data name="output1" format="bed"/>
	</outputs>
	<tests>
		<test>
			<param name="input_query" value="megablast_query.fa" ftype="fasta"/>
			<param name="source_select" value="nt" />
			<param name="output_format" value="bed" />
			<param name="word_size" value="28" />
			<param name="iden_cutoff" value="0.0" />
			<param name="disc_word" value="0" />
			<param name="disc_type" value="0" />
			<param name="filter_query" value="T" />
			<output name="output1" file="megablast_test.out"/> 
		</test>
		<test>
			<param name="input_query" value="megablast_query.fa" ftype="fasta"/>
			<param name="source_select" value="nt" />
			<param name="output_format" value="bed" />
			<param name="word_size" value="16" />
			<param name="iden_cutoff" value="99.0" />
			<param name="disc_word" value="0" />
			<param name="disc_type" value="1" />
			<param name="filter_query" value="T" />
			<output name="output1" file="megablast_test_1.out"/> 
		</test>
	</tests>
	<help>

.. class:: infomark

 **megablast**: Zhang et al. A Greedy Algorithm for Aligning DNA Sequences. 2000. JCB: 203-214.

-----

**What it does**

This tool runs **megablast**, which searches a nucleotide database using nucleotide sequences. 
The query sequence could be any nucleotide sequences in fasta format. 
The output is in bed format. 
At this point, only **nt** is available for searching. 

Other databases and megablast parameters will be available shortly.

-----

**Example**

Query sequences::

	&gt;chr1 147962192 147962580
	ACTTGATCCTGCTCCCTCGGTGTCTGCATTGACTCCTCATGCTGGGACTG
	GACCCGTCAACCCCCCTGCTCGCTGCTCACGTACCTTCATCACTTTTAGT
	GATGATGCAACTTTCGAGGAATGGTTCCCCCAAGGGCGGCCCCCAAAAGT
	CCCTGTTCGTGAGGTCTGTCCAGTGACCCATCGTCCAGCCCTATACCGGG
	ACCCTGTTACAGACATACCCTATGCCACTGCTCGAGCCTTCAAGATCATT
	CGTGAGGCTTACAAGAAGTACATTACTGCCCATGGACTGCCGCCCACTGC
	CTCAGCCCTGGGCCCCGGCCCGCCACCTCCTGAGCCCCTCCCTGGCTCTG
	GGCCCCGAGCCTTGCGCCAGAAAATTGTCATTAAATGA
	&gt;chr10 55251623 55253124
	TCTTTTCCTTCTCTACCATTTTCAACAAAGCAGGGGAAATAACTCAGTCT
	CAGAAGACAGGAAACATCAACAAGTTGTGATGCCCTTTTCTTCCAATACT
	ATTGAGGCTCACAAGTCAGCTCATGTAGACGGATCACTTAAGAGCAACAA
	ACTGAAGTCTGCAAGAAAATTCACATTTCTATCTGATGAGGATGACTTAA
	GTGCCCATAATCCCCTTTATAAGGAAAACATAAGTCAAGTATCAACAAAT
	TCAGACATTTCACAGAGAACAGATTTTGTAGACCCATTTTCACCCAAAAT
	ACAAGCCAAGAGTAAGTCTCTGAGGGGCCCAAGAGAAAAGATTCAGAGGC
	TGTGGAGTCAGTCAGTCAGCTTACCCAGGAGGCTGATGAGGAAAGTTCCA
	AATAGACCAGAGATCATAGATCTGCAGCAGTGGCAAGGCACCAGGCAGAA
	AGCTGAAAATGAAAACACTGGAATCTGTACAAACAAAAGAGGTAGCAGCA

Search above query sequences in the nt database::

	gi|5174714|ref|NM_005997.1| 751 1138 chr1 0 -
	gi|806525|dbj|D43643.1|MUSYL1PB 805 1132 chr1 0 -
	
	</help>
</tool>
