<tool id="megablast_wrapper" name="Megablast" version="1.0.0">
	<description>for Metagenomics Projects</description>
	<command interpreter="python">megablast_wrapper.py $source_select $input_query $output1 $word_size $iden_cutoff $disc_word $disc_type $filter_query ${GALAXY_DATA_INDEX_DIR}</command>
	<inputs>
		<param name="input_query" type="data" format="fasta" label="Query Sequence"/>
		<param name="source_select" type="select" display="radio" label="Target database">
			<options from_file="blastdb.loc" name_col="0" value_col="0"/>
		</param> 
		<param name="word_size" type="select" label="Word size (-W)" help="Size of best perfect match">
			<option value="28">28</option>
			<option value="16">16</option>
		</param>
		<param name="iden_cutoff" type="float" size="15" value="0.0" label="Identity percentage cut-off (-p)" help="no cutoff if 0" />
		<param name="disc_word" type="integer" size="15" value="0" label="Length of a discontiguous word template (-t)" help="contiguous word if 0"/>
		<param name="disc_type" type="select" label="Type of a discontiguous word template (-N)">
			<option value="0">0 - coding</option>
			<option value="1">1 - optimal</option>
			<option value="2">2 - two simultaneous</option>
		</param>
		<param name="filter_query" type="select" label="Filter query sequence (-F)">
			<option value="T">Yes</option>
			<option value="F">No</option>
		</param>
	</inputs>
	<outputs>
		<data name="output1" format="tabular"/>
	</outputs>
	<tests>
		<test>
			<param name="input_query" value="megablast_wrapper_test1.fa" ftype="fasta"/>
			<param name="source_select" value="test" />
			<param name="word_size" value="28" />
			<param name="iden_cutoff" value="99.0" />
			<param name="disc_word" value="0" />
			<param name="disc_type" value="0" />
			<param name="filter_query" value="T" />
			<output name="output1" file="megablast_wrapper_test1.out"/> 
		</test>
	</tests>
	<help>
	
.. class:: warningmark

 Search nt database might require few hours before returning the result.

-----

**What it does**

This tool runs **megablast** (for information about megablast, please see the reference below) and search against a nucleotide database. 
The query sequence could be any nucleotide sequences in fasta format. At this point, only **nt** is available for searching. 

Other databases and megablast parameters will be available shortly.

-----

**Parameters**

- **-W**: Word size
- **-p**: Identity percentage cut-off
- **-t**: Length of a discontiguous word template
- **-N**: Type of a discontiguous word template
- **-F**: Filter query sequence

-----

**Reference**

 **megablast**: Zhang et al. A Greedy Algorithm for Aligning DNA Sequences. 2000. JCB: 203-214.

	</help>
</tool>
