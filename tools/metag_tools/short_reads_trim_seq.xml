<tool id="trim_reads" name="Trim Reads">
<description>based on quality scores</description>

<command interpreter="python">#if $sequencing_method_choice.sequencer=="454":#short_reads_trim_seq.py 454 $trim $length $output1 $input1 $input2
#else:#short_reads_trim_seq.py solexa $trim $length $output1 $input1 $input2 
#end if
</command>

<inputs>
<page>
	<conditional name="sequencing_method_choice">
		<param name="sequencer" type="select" label="short read sequencing method">
			<option value="454">454</option>
			<option value="Solexa">Solexa</option>
		</param>
		<when value="454">
		    <param name="input1" type="data" format="fasta,txtseq.zip" label="Sequence file" />
    		    <param name="input2" type="data" format="txt,txtseq.zip" label="Score file" />
		</when>
		<when value="Solexa">
    		<param name="input1" type="data" format="tabular,txtseq.zip" label="Sequence file" />
    		<param name="input2" type="data" format="tabular,txtseq.zip" label="Score file" />
		</when>	
	</conditional>
	<param name="trim" type="integer" size="5" value="20" label="Minimal quality score" />
    <param name="length" type="integer" size="5" value="0" label="Minimal length of trimmed reads to report" help="To output the read if its length is longer than this threshold. Use 0 to return the longest substring" />
</page>
</inputs>

<outputs>
    <data name="output1" format="fasta" />
</outputs>

<tests>
	<test>
		<param name="sequencer" value="Solexa" />
		<param name="input1" value="solexa.fna" />
		<param name="input2" value="solexa.qual" />
		<param name="trim" value="20" />
		<param name="length" value="0" />
		<output name="output1" file="solexaTest.fa" />
	</test>
	<test>
		<param name="sequencer" value="454" />
		<param name="input1" value="454.fna" />
		<param name="input2" value="454.qual" />
		<param name="trim" value="20" />
		<param name="length" value="0" />
		<output name="output1" file="454Test.fa" />
	</test>
</tests>

<help>

.. class:: warningmark 

 Please select correct sequencing method.
 
-----

**What it does**

This tool takes raw data from sequencing facility and outputs a multi-fasta file.

Accept the following two file formats:

- fasta: for **454** data
- tabular: for **Solexa** data. Only take the maximal value from each 4 quality scores.

If *minimal trimmed length to report* is set to a number larger than zero, the tool ouputs any substrings that are longer than this threshold. 
If there are more than one substring, the tool outputs all of them in separated fasta format.

-----


454 data::

	&gt;seq1
	CCGGTATCCG
	
454 quality score::

	&gt;seq1
	33 19 34 25 28 28 28 32 15 34 

454 Output (trimmed by quality score 20 and returned the longest substring)::

	&gt;seq1
	GGTATC

Solexa data::

	5	300	902	419	TTCTTACCTATTAGTGGTTGAACATC


Solexa quality score (only showed the maximum value)::
	  
 	40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 15 40
	
Solexa Output::

	&gt;15774
	TTCTTACCTATTAGTGGTTGAACA
	
The fasta title will be replaced by a unique number in Solexa output.

</help>
</tool>
