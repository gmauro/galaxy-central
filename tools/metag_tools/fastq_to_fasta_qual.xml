<tool id="fastq_to_fasta_qual" name="FASTQ-to-FASTA-QUAL" version="1.0.0">
  <description>extracts sequences and quality scores from FASTQ data</description>
  <command interpreter="python">fastq_to_fasta_qual.py $input1 $output1 $output2 $input1.extension</command>
  <inputs>
    <param name="input1" type="data" format="fastq,fastqsolexa" label="Fastq file"/>
  </inputs>
  <outputs>
    <data name="output1" format="fasta"/>
    <data name="output2" format="qual"/>
  </outputs>
  <tests>
    <!-- NOTE: this tool generates 2 output files, but our functional tests currently only handle the last one generated -->
    <test>
      <param name="input1" value="1.fastq" ftype="fastq" />
      <output name="output1" file="fastq_to_fasta_qual_out2.fasta" />
    </test>
    <test>
      <param name="input1" value="1.fastqsolexa" ftype="fastq" />
      <output name="output1" file="fastq_to_fasta_qual_out4.fasta" />
    </test>
  </tests>
  <help>

.. class:: warningmark

IMPORTANT: With the Fastq Solexa variant, this tool currently only works with data where the quality scores are integers, ASCII quality scores are not supported.

-----

**What it does**

This tool extracts sequences and quality scores from FASTQ data ( both Sanger/Standard and Solexa variants ), producing a FASTA dataset and a QUAL dataset.  With the Solexa variant, this tool currently only works with data where the quality scores are integers, ASCII quality scores are not supported.

-----

**Example1**

- Converting the following Sanger/Standard fastq data::

    @EAS54_6_R1_2_1_413_324
    CCCTTCTTGTCTTCAGCGTTTCTCC
    +
    ;;3;;;;;;;;;;;;7;;;;;;;88
    @EAS54_6_R1_2_1_540_792
    TTGGCAGGCCAAGGCCGATGGATCA
    +
    ;;;;;;;;;;;7;;;;;-;;;3;83
    @EAS54_6_R1_2_1_443_348
    GTTGCTTCTGGCGTGGGTGGGGGGG
    +EAS54_6_R1_2_1_443_348
    ;;;;;;;;;;;9;7;;.7;393333


- will extract the following sequences::

    >EAS54_6_R1_2_1_413_324
    CCCTTCTTGTCTTCAGCGTTTCTCC
    >EAS54_6_R1_2_1_540_792
    TTGGCAGGCCAAGGCCGATGGATCA
    >EAS54_6_R1_2_1_443_348
    GTTGCTTCTGGCGTGGGTGGGGGGG

- and quality scores::

    >EAS54_6_R1_2_1_413_324
    26 26 18 26 26 26 26 26 26 26 26 26 26 26 26 22 26 26 26 26 26 26 26 23 23 
    >EAS54_6_R1_2_1_540_792
    26 26 26 26 26 26 26 26 26 26 26 22 26 26 26 26 26 12 26 26 26 18 26 23 18 
    >EAS54_6_R1_2_1_443_348
    26 26 26 26 26 26 26 26 26 26 26 24 26 22 26 26 13 22 26 18 24 18 18 18 18 


**Example2**

- Converting the following Solexa fastq data::

    @HANNIBAL_1_FC302VTAAXX:2:1:228:167
    GAATTGATCAGGACATAGGACAACTGTAGGCACCAT
    +HANNIBAL_1_FC302VTAAXX:2:1:228:167
    40 40 40 40 35 40 40 40 25 40 40 26 40 9 33 11 40 35 17 40 40 33 40 7 9 15 3 22 15 30 11 17 9 4 9 4
    @HANNIBAL_1_FC302VTAAXX:2:1:156:340
    GAGTTCTCGTCGCCTGTAGGCACCATCAATCGTATG
    +HANNIBAL_1_FC302VTAAXX:2:1:156:340
    40 15 40 17 6 36 40 40 40 25 40 9 35 33 40 14 14 18 15 17 19 28 31 4 24 18 27 14 15 18 2 8 12 8 11 9

- will extract the following sequences::

    >HANNIBAL_1_FC302VTAAXX:2:1:228:167
    GAATTGATCAGGACATAGGACAACTGTAGGCACCAT
    >HANNIBAL_1_FC302VTAAXX:2:1:156:340
    GAGTTCTCGTCGCCTGTAGGCACCATCAATCGTATG

- and quality scores::

    >HANNIBAL_1_FC302VTAAXX:2:1:228:167
    40 40 40 40 35 40 40 40 25 40 40 26 40 9 33 11 40 35 17 40 40 33 40 7 9 15 3 22 15 30 11 17 9 4 9 4
    >HANNIBAL_1_FC302VTAAXX:2:1:156:340
    40 15 40 17 6 36 40 40 40 25 40 9 35 33 40 14 14 18 15 17 19 28 31 4 24 18 27 14 15 18 2 8 12 8 11 9

    </help>
</tool>
