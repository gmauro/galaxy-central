<tool id="Extract genomic DNA 1" name="Extract genomic DNA">
  <description>using coordinates from assembled genomes</description>
  <command interpreter="perl">fasta-subseq-wrapper.pl -i $input -o $out_file1 -p $input_chromCol $input_startCol $input_endCol $input_strandCol -g $dbkey -f $out_format</command>
  <inputs>
    <param format="interval" name="input" type="data" label="Fetch sequences corresponding to Query"><validator type="dataset_metadata_in_file" filename="/depot/data2/galaxy/alignseq.loc" metadata_name="dbkey" metadata_column="1" message="Sorry, sequences are not currently available for the specified genome. You may request them via email." split=" " line_startswith = "seq" /></param>
	<param name="out_format" type="select" label="Output Type">
	<option value="0">FASTA</option>
	<option value="1">Interval</option>
	</param>
  </inputs>
  <outputs>
    <data format="fasta" name="out_file1" />
  </outputs>
  <code file="fasta-subseq-wrapper_code.py" />
  <tests>
    <test>
      <param name="input" value="1.bed" dbkey="hg17" ftype="bed" />
      <param name="out_format" value="0"/>
      <output name="out_file1" file="fsa_extract_genomic_dna.dat" />
    </test>
  </tests>
  <help>

.. class:: warningmark

Make sure that the genome build is specified for the interval dataset you are extracting sequences for (click the pencil icon if it is not specified). However, if the build is specified and the tool still gives you an error, your genome of interest may only be partially assembled (ie, in scaffolds).  To extract sequences from such partially assembled genomes use *Extract Genomic DNA from unassmebled genomes* tool.

.. class:: infomark

Why do we have two sequence extractors?

 * **Extract genomic DNA using coordinates from ASSEMBLED genomes** (this tool) - will work for most cases when your intervals are located on assembled chromosomes (i.e., chr1, chrX, etc.)
 * **Extract genomic DNA using coordinates from UNassembled genomes** - is designed to work on partially assembled or unassembled genomes when your intervals are located in contigs or scaffolds rather than assembled chromosomes (i.e., super_1 etc.)

These two tools will be merged in the future.

-----

**What it does**

This tool uses coordinate, strand, and build information to fetch genomic DNAs in FASTA format.

-----

**Example**

Input dataset::

    chr7  127475281  127475310  NM_000230  0  +
    chr7  127485994  127486166  NM_000230  0  +
    chr7  127486011  127486166  D49487     0  +

Fetch genomic DNAs of the above data::

    &gt;hg17_chr7_127475281_127475310_+
    GTAGGAATCGCAGCGCCAGCGGTTGCAAG
    &gt;hg17_chr7_127485994_127486166_+
    GCCCAAGAAGCCCATCCTGGGAAGGAAAATGCATTGGGGAACCCTGTGCG
    GATTCTTGTGGCTTTGGCCCTATCTTTTCTATGTCCAAGCTGTGCCCATC
    CAAAAAGTCCAAGATGACACCAAAACCCTCATCAAGACAATTGTCACCAG
    GATCAATGACATTTCACACACG
    &gt;hg17_chr7_127486011_127486166_+
    TGGGAAGGAAAATGCATTGGGGAACCCTGTGCGGATTCTTGTGGCTTTGG
    CCCTATCTTTTCTATGTCCAAGCTGTGCCCATCCAAAAAGTCCAAGATGA
    CACCAAAACCCTCATCAAGACAATTGTCACCAGGATCAATGACATTTCAC
    ACACG

</help>
</tool>
