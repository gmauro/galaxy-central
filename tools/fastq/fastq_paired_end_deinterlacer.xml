<tool id="fastq_paired_end_deinterlacer" name="FASTQ de-interlacer" version="1.0.0">
  <description>on paired end reads</description>
  <command interpreter="python">fastq_paired_end_deinterlacer.py '$input1_file' '${input1_file.extension[len( 'fastq' ):]}' '$output1_file' '$output2_file'</command>
  <inputs>
    <param name="input1_file" type="data" format="fastqsanger,fastqcssanger" label="FASTQ reads" />
  </inputs>
  <outputs>
    <data name="output1_file" format="input" />
    <data name="output2_file" format="input" />
  </outputs>
  <tests>
    <test>
      <param name="input1_file" value="paired_end_merged.fastqsanger" ftype="fastqsanger" />
      <output name="output1_file" file="paired_end_1.fastqsanger" />
      <output name="output2_file" file="paired_end_2.fastqsanger" />
    </test>
    <test>
      <param name="input1_file" value="paired_end_merged_errors.fastqsanger" ftype="fastqsanger" />
      <output name="output1_file" file="paired_end_1_cleaned.fastqsanger" />
      <output name="output2_file" file="paired_end_2_cleaned.fastqsanger" />
    </test>
  </tests>
  <help>
**What it does**

De-interlaces a single fastq dataset representing paired-end run into two fastq datasets containing only the first or second mate read. Reads without mate are excluded from the output files.

Sequence identifiers for paired-end reads must follow the /1 and /2 convention.

-----

**Input**

A multiple-fastq file containing paired-end reads, for example::

    @1539:931/1
    ACTTCCCGCGCGTGAAGGCGCCGGCAAACGAGGCTCGGGAAGGGGCTCCCG
    +1539:931/1
    BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
    @1539:931/2
    CGCCATTCCGAATCGTAGTTGTCGGCGTCTTCCAGTGCGGCAAGGCATCGT
    +1539:931/2
    WNUUZ\P^`BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB

-----

**Output**

Multi-fastq file with left-hand mate only::

    @1539:931/1
    ACTTCCCGCGCGTGAAGGCGCCGGCAAACGAGGCTCGGGAAGGGGCTCCCG
    +1539:931/1
    BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB

Multi-fastq file with right-hand mate only::

    @1539:931/2
    CGCCATTCCGAATCGTAGTTGTCGGCGTCTTCCAGTGCGGCAAGGCATCGT
    +1539:931/2
    WNUUZ\P^`BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB

  </help>
</tool>
