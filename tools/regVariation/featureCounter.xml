<tool id="featureCoverage1" name="Feature coverage" version="1.0.0">
  <description></description>
  <command interpreter="python2.4">featureCounter.py $input1 $input2 $output -1 $input1_chromCol,$input1_startCol,$input1_endCol,$input1_strandCol -2 $input2_chromCol,$input2_startCol,$input2_endCol,$input2_strandCol</command>
  <inputs>
    <param format="interval" name="input1" type="data" help="First query">
      <label>What portion of</label>
    </param>
    <param format="interval" name="input2" type="data" help="Second query">
      <label>is covered by</label>
    </param>
   </inputs>
  <outputs>
    <data format="interval" name="output" metadata_source="input1" />
  </outputs>
  
  <tests>
    <test>
      <param name="input1" value="1.bed" />
      <param name="input2" value="2.bed" />
      <output name="output" file="6_feature_coverage.bed" />
    </test>
  </tests>
  <help>

.. class:: infomark

**What it does**

This tool finds the coverage of intervals in the first query on intervals in the second query. The count and coverage are added as 3 new columns in the resulting dataset.

-----

**Example**

- If **First query** consists of the following windows::

    chrX 1     10001 seg 0 -
    chrX 10001 20001 seg 0 -
    chrX 20001 30001 seg 0 -
    chrX 30001 40001 seg 0 -
      
- and **Second query** consists of the following exons::

    chrX 5000  6000  seg2 0 -
    chrX 5500  7000  seg2 0 -
    chrX 9000  22000 seg2 0 -
    chrX 24000 34000 seg2 0 -
    chrX 36000 38000 seg2 0 -
      
- the **Result** is the coverage of exons of the second query in each of the windows contained in first query::

    chrX 1     10001 seg 0 - 2 1 30.01
    chrX 10001 20001 seg 0 - 1 0 100.00
    chrX 20001 30001 seg 0 - 0 2 80.00
    chrX 30001 40001 seg 0 - 1 1 59.99
	  
- To clarify, the following line of output ( added columns are indexed by a, b and c )::

                         a b c
    chrX 1 10001 seg 0 - 2 1 30.01
                                  
  implies that 2 exons (a) fall into this window ( chrX:1-10001 ), 1 exon (b) partially overlaps this window, and these 3 exons cover 30.01% of the window size (c).

  * a: number of features in the 2nd query that fall **completely** within this window
  * b: number of features in the 2nd query that partially overlap this window
  * c: % of window size covered by features in (a) and (b) - features overlapping with each other will be merged to calculate (c)
	 
</help>
</tool>
