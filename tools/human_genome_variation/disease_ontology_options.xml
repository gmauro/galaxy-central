<tool id="hgv_disease_ontology" name="FunDO" Version="1.0.0">
  <description>human genes associated with Disease Ontology terms</description>

  <command interpreter="perl">
    disease_ontology_gene_fuzzy_selector.pl $build $out_file1 ${GALAXY_DATA_INDEX_DIR}/disease_ontology.loc '$term'
  </command>

  <inputs>
    <param name="build" type="select" label="Database build">
      <options from_file="disease_ontology.loc">
        <column name="name" index="0"/>
        <column name="value" index="0"/>
        <filter type="unique_value" column="0"/>
      </options>
    </param>
    <param name="term" size="40" type="text" label="Enter Term " help="Entering disease will result in using all genes associated with any disease, or enter a term or space delimited list of terms."/>
  </inputs>

  <outputs>
    <data format="tabular" name="out_file1"/>
  </outputs>

  <tests>
    <test>
      <param name="term" value="lung"/>
      <param name="build" value="hg18"/>
      <output name="out_file1" file="disease_ontology_1.out" />
    </test>
  </tests>

  <help>
**Data format**

There is no input dataset.  The output is tabular_ format.

.. _tabular: ./static/formatHelp.html#tab

-----

**What it does**

This returns a set of genes that are associated with the disease term(s).  This uses the entered text to search for terms matching a pattern.  The search is case insensitive and the text is split on spaces and matches to any words are returned.  The output includes gene coordinates, name, disease ontology ID and term.  Entering disease would return all genes associated with disease.

-----

**Example**

Typing:: 

    carcinoma

results in::

    1.          2.              3.              4.      5.      6.      7.              8.
    chr8	18293034	18303003	+	10	NAT2	DOID:1994	carcinoma of the large Intestine
    chr8	18293034	18303003	+	10	NAT2	DOID:2876	laryngeal squamous cell carcinoma
    chr8	18293034	18303003	+	10	NAT2	DOID:3459	breast carcinoma
    chr8	18293034	18303003	+	10	NAT2	DOID:4947	cholangiocarcinoma
    chr1	241733106	242073176	-	10000	AKT3	DOID:3744	cervical squamous cell carcinoma
    chr1	241718157	242073176	-	10000	AKT3	DOID:3744	cervical squamous cell carcinoma
    etc.

Where::

 1. is the chromosome name.
 2. is the start position of the gene.
 3. is the end position of the gene.
 4. is the strand.
 5. is the Entrez Gene ID.
 6. is the gene name.
 7. is the disease ontology ID.
 8. is the disease ontology term.

-----

**Reference**

Osborne JD, Flatow J, Holko M, Lin SM, Kibbe WA, Zhu LJ, Danila MI, Feng G, Chisholm RL. Annotating the human genome with Disease Ontology. BMC Genomics (2009) 10 S1:S6.
  </help>
</tool>
